<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>N√≥minas</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h1>üóÇÔ∏èN√≥minas</h1>
    <p class="subtitle">Compara el Excel nuevo (quincenal) con el Excel base y genera un archivo fusionado.</p>

    <div class="upload-section">
      <div class="upload-box">
        <label for="fileNuevo">üìÑ Excel Nuevo (Quincenal)</label>
        <input type="file" id="fileNuevo" accept=".xlsx,.xls">
        <p class="file-name" id="fileNuevoName">Sin archivo</p>
        <p class="hint">Columnas: TIPOPAGO, NUE, NUP, RFC, CURP, NOMBRE, CATEGORIA, PUESTO, PROYECTO, NOMINA, DESDE, HASTA, LIQUIDO</p>
      </div>

      <div class="upload-box">
        <label for="fileBase">üìã Excel Base</label>
        <input type="file" id="fileBase" accept=".xlsx,.xls">
        <p class="file-name" id="fileBaseName">Sin archivo</p>
        <p class="hint">Columnas: NUM, NOMBRE, RFC, CUENTA, BANCO, TELEFONO, CORREO ELECTRONICO, SE ENVIA SOBRE A</p>
      </div>

      <div class="upload-box optional">
        <label for="fileCash">üíµ Excel Efectivo (Opcional)</label>
        <input type="file" id="fileCash" accept=".xlsx,.xls">
        <p class="file-name" id="fileCashName">Sin archivo</p>
        <p class="hint">Columnas: RFC, NOMBRE, MODALIDAD, MONTO ‚Äî Excluye estos de las altas</p>
        <button type="button" id="btnClearCash" class="btn-clear hidden">‚úï Quitar</button>
      </div>
    </div>

    <button id="btnMerge" class="btn-primary" disabled>üîÄ Comparar y Fusionar</button>

    <div id="results" class="results hidden">
      <div class="summary">
        <div class="stat alta">
          <span class="stat-num" id="countAltas">0</span>
          <span class="stat-label">Altas</span>
        </div>
        <div class="stat baja">
          <span class="stat-num" id="countBajas">0</span>
          <span class="stat-label">Bajas</span>
        </div>
        <div class="stat total">
          <span class="stat-num" id="countTotal">0</span>
          <span class="stat-label">Total final</span>
        </div>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="altas">üü¢ Altas</button>
        <button class="tab" data-tab="bajas">üî¥ Bajas</button>
        <button class="tab" data-tab="final">üìä Resultado Final</button>
      </div>

      <div class="tab-content" id="tabAltas">
        <table id="tableAltas">
          <thead><tr></tr></thead>
          <tbody></tbody>
        </table>
        <p class="empty-msg hidden">No hay altas en este periodo.</p>
      </div>

      <div class="tab-content hidden" id="tabBajas">
        <table id="tableBajas">
          <thead><tr></tr></thead>
          <tbody></tbody>
        </table>
        <p class="empty-msg hidden">No hay bajas en este periodo.</p>
      </div>

      <div class="tab-content hidden" id="tabFinal">
        <table id="tableFinal">
          <thead><tr></tr></thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="action-buttons">
        <button id="btnDownload" class="btn-success">‚¨áÔ∏è Descargar Excel Fusionado</button>
        <button id="btnSplit" class="btn-secondary">üìÇ Separar por Proyecto/N√≥mina/TipoPago/Banco</button>
      </div>
    </div>

    <!-- Split Results Section -->
    <div id="splitResults" class="split-results hidden">
      <h2>üìÅ Archivos Generados</h2>
      <p class="split-description">Archivos separados por: Proyecto (Jard√≠n/Otros) ‚Üí N√≥mina ‚Üí TipoPago ‚Üí Banco</p>
      
      <!-- Payroll period selector for Banamex format -->
      <div class="payroll-period">
        <label>Periodo de N√≥mina (para Banamex):</label>
        <select id="selectQuincena">
          <option value="1a">1a Quincena</option>
          <option value="2a">2a Quincena</option>
        </select>
        <select id="selectMes">
          <option value="Ene">Enero</option>
          <option value="Feb">Febrero</option>
          <option value="Mar">Marzo</option>
          <option value="Abr">Abril</option>
          <option value="May">Mayo</option>
          <option value="Jun">Junio</option>
          <option value="Jul">Julio</option>
          <option value="Ago">Agosto</option>
          <option value="Sep">Septiembre</option>
          <option value="Oct">Octubre</option>
          <option value="Nov">Noviembre</option>
          <option value="Dic">Diciembre</option>
        </select>
      </div>
      
      <div id="splitTree" class="split-tree"></div>
      <button id="btnDownloadAll" class="btn-success">‚¨áÔ∏è Descargar Todos los Archivos</button>
    </div>
  </div>

  <!-- SheetJS from CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
